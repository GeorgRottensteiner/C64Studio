<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<HEAD>
  <link rel="stylesheet" type="text/css" href="msoffice.css" />
  <Title>C64 Studio</Title>
</HEAD>

<body>
  <H3>BASIC - Dialects</H3>
  <div id="mybody">
    There exist several BASIC dialects. BASIC V2 is hard wired, but any others can be configured externally.<br>
    <br>
    Laser BASIC and BASIC Lightning have been special cased as their parser seems to behave differently from the common parser.<br>
    <br>
    Adding new BASIC dialects with new token byte values (one or two bytes) is the expected process.<br>
    <br>
    <br>
  </div>
  <H2>BASIC Dialect File</H2>
  <div id="mybody">
    Several BASIC dialects come with C64Studio in the sub folder "BASIC Dialects". They are pretty self explanatory, a combination of text and CSV format file.<br>
    <br>
    C64Studio reads all dialect files on startup. If there are any format errors a message is added to the "Output" view.<br>
    <br>
    <br>
    Lines starting with # or empty lines are skipped.<br>
    A dialect file consists of two sections, a first where several meta data are defined. Any undefined values are then treated as CSV sections, with semicolon as separator character.
    The current supported meta data parameters are:<br>
    <table>
      <tr>
        <th>
          Parameter
        </th>
        <th>
          Expected content
        </th>
        <th>
          Description
        </th>
        <th>
          Example
        </th>
      </tr>
      <tr>
        <td>
          StartAddress
        </td>
        <td>
          decimal value
        </td>
        <td>
          Default start address for BASIC code
        </td>
        <td>
          StartAddress=2049
        </td>
      </tr>
      <tr>
        <td>
          SafeLineLength
        </td>
        <td>
          decimal value
        </td>
        <td>
          Number of characters that can be used for a line with native methods
        </td>
        <td>
          SafeLineLength=80
        </td>
      </tr>
      <tr>
        <td>
          MaxLineLength
        </td>
        <td>
          decimal value
        </td>
        <td>
          Maximum number of characters that can be used for a line (technically)
        </td>
        <td>
          MaxLineLength=250
        </td>
      </tr>
      <tr>
        <td>
          MaxLineNumber
        </td>
        <td>
          decimal value
        </td>
        <td>
          Maximum allowed line number
        </td>
        <td>
          MaxLineNumber=63999
        </td>
      </tr>
      <tr>
        <td>
          VariableRelevantLength
        </td>
        <td>
          decimal value
        </td>
        <td>
          Maximum number of characters of a variable name that is relevant
        </td>
        <td>
          VariableRelevantLength=2
        </td>
      </tr>
      <tr>
        <td>
          CompileType
        </td>
        <td>
          One of PLAIN, PRG, P_ZX81 (Default is PRG)
        </td>
        <td>
          If set defines the default compile target type if not overridden by the project
        </td>
        <td>
          CompileType=P_ZX81
        </td>
      </tr>
      <tr>
        <td>
          Machines
        </td>
        <td>
          One of C64, VIC20, C128, PLUS4, PET, CBM, ATARI2600, MEGA65, NES, COMMANDER_X16, CPC, ZX80, ZX81, ZX_SPECTRUM, AMIGA
        </td>
        <td>
          Machines that can use this BASIC dialect. Several machines can be defined separated by commas.
          Used to chose the proper key mapping.
        </td>
        <td>
          Machines=C64,VIC20
        </td>
      </tr>
      <tr>
        <td>
          HexPrefix
        </td>
        <td>
          character
        </td>
        <td>
          Defines a character to be used as prefix to hexadecimal values
        </td>
        <td>
          HexPrefix=$
        </td>
      </tr>
      <tr>
        <td>
          BinPrefix
        </td>
        <td>
          character
        </td>
        <td>
          Defines a character to be used as prefix to binary values
        </td>
        <td>
          HexPrefix=%
        </td>
      </tr>
      <tr>
        <td>
          HasTextLabels
        </td>
        <td>
          none
        </td>
        <td>
          Lets the parser know that this dialect supports text labels (e.g. PROC names with TSB)
        </td>
        <td>
          HasTextLabels
        </td>
      </tr>
      <tr>
        <td>
          NoCaseToggle
        </td>
        <td>
          none
        </td>
        <td>
          If set the user cannot toggle between upper/lower case
        </td>
        <td>
          NoCaseToggle
        </td>
      </tr>
      <tr>
        <td>
          Lowercase
        </td>
        <td>
          none
        </td>
        <td>
          If set the editor defaults to lower case
        </td>
        <td>
          Lowercase
        </td>
      </tr>
      <tr>
        <td>
          ExtendedTokensRecognizedInsideComment
        </td>
        <td>
          none
        </td>
        <td>
          If set the parser tokenizes BASIC tokens even inside comments
        </td>
        <td>
          ExtendedTokensRecognizedInsideComment
        </td>
      </tr>
    </table>
    <br>
    <br>
    A line "ExOpcodes" starts the extended opcode section. These are used for C64Studio internally.<br>
    All other lines are expected to contain at least three csv columns, separated by semicolon. A fourth column is optional, containing additional info regarding line numbers; crucial for renumbering.<br>
    The first csv line is treated as header and also skipped.<br>
    <br>
    The three columns are "BASIC Token", "Byte Value(s)", and "BASIC Abbreviation". The optional fourth column defines whether and how line numbers are set with the token.<br>
    <br>
    Extended example:<br>
    <br>
    <div id="code"><br>    GOTO;89;gO;listoflinenumbers
    RUN;8a;rU;linenumberat:0
    </div><br>
    GOTO/RUN is the regular BASIC command.<br>
    <br>
    89/8a is the hexadecimal representation of the byte value(s) to be inserted. C64Studio supports one byte, and two byte tokens.<br>
    <br>
    gO/rU are the abbreviations.<br>
    <br>
    The additional info defines how and where line numbers may follow. These are the current possible values:<br>
    <table>
      <tr>
        <th>
          Value
        </th>
        <th>
          Expected content
        </th>
        <th>
          Description
        </th>
        <th>
          Example
        </th>
      </tr>
      <tr>
        <td>
          comment
        </td>
        <td>
          none
        </td>
        <td>
          The token is a comment (used for syntax coloring, and parsing of the line)
        </td>
        <td>
          REM;8F;;comment
        </td>
      </tr>
      <tr>
        <td>
          gotoken
        </td>
        <td>
          none
        </td>
        <td>
          An TO token may follow (e.g. GO TO), used for the parser, as GO TO works as GOTO
        </td>
        <td>
          GO;CB;;gotoken
        </td>
      </tr>
      <tr>
        <td>
          prelabeltoken
        </td>
        <td>
          none
        </td>
        <td>
          A text label follows this token
        </td>
        <td>
          THEN;A7;tH;prelabeltoken,linenumberat:0
        </td>
      </tr>
      <tr>
        <td>
          reverseonly
        </td>
        <td>
          none
        </td>
        <td>
          Defines a token to only be available for disassembling, skipped when assembling
        </td>
        <td>
          "";C0;;reverseonly
        </td>
      </tr>
      <tr>
        <td>
          linelistrange
        </td>
        <td>
          line number-linenumber or line number- or -line number
        </td>
        <td>
          A list of line numbers, separated by comma
        </td>
        <td>
          LIST;9B;lI;linelistrange
        </td>
      </tr>
      <tr>
        <td>
          listoflinenumbers
        </td>
        <td>
          line number[,line number[,...]]
        </td>
        <td>
          A list of line numbers, separated by comma (e.g. ON ... GOSUB)
        </td>
        <td>
          GOSUB;8D;goS;listoflinenumbers
        </td>
      </tr>
      <tr>
        <td>
          linenumberat
        </td>
        <td>
          :[parameter index]
        </td>
        <td>
          Defines which parameter (separated by comma) after the token is a line number
        </td>
        <td>
          COLLISION;fe17;;linenumberat:1
        </td>
      </tr>
    </table>
    <br>
    <br>
  </div>
</body>
</HTML>
